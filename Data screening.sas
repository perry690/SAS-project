/******create a library******/
LIBNAME hi 'G:\rutgers\computing\project';  

/******sort data by subject and combine six datasets******/
PROC SORT data = hi.bp out = bp;                                                                                                                                                                                                                                
    By subject;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
PROC SORT data = hi.demog out = demog;                                                                                                                                                                                                                          
    By subject;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
PROC SORT data = hi.glucose out = glucose;                                                                                                                                                                                                                      
    By subject;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
PROC SORT data = hi.hw out = hw;                                                                                                                                                                                                                                
    By subject;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
PROC SORT data = hi.lipid out = lipid;                                                                                                                                                                                                                          
    By subject;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
PROC SORT data = hi.misc out = misc;                                                                                                                                                                                                                            
    By subject;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*******format combined dataset and create a new variable age******/                                                                                                                                                                     
Data hi.combine;                                                                                                                                                                                                                                                
MERGE bp demog glucose hw lipid misc;                                                                                                                                                                                                                           
    By subject;                                                                                                                                                                                                                                                 
age = (dov - dob)/365.25;                                                                                                                                                                                                                                       
FORMAT age 5.2 dov dob doe DATE9.;                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
PROC SORT data = hi.combine;                                                                                                                                                                                                                                    
 By subject;                                                                                                                                                                                                                                                    
run; 

/******check data descriptions using proc means statement******/
proc means data = hi.combine;                                                                                                                                                                                                                                   
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/******create five temporary dataset for each site******/                                                                                                                                                                                    
data one two three four five;                                                                                                                                                                                                                                   
set hi.combine;                                                                                                                                                                                                                                                 
run;    


/*****************************checking typos***********************/                                                                                                                                                                                            
/******************only smoke and marital has typos according to the results*******************/                                                                                                                                                                                         
/*checking ahead for the whole combine data because some variables don't have any typos, therefore later we don't have to repeat checking each one by site, which simplifies the code length*/                                                                  
data temp01;  *no typos;                                                                                                                                                                                                                                        
set hi.combine;                                                                                                                                                                                                                                                 
if gender = 'M' then delete;                                                                                                                                                                                                                                    
if gender = 'F' then delete;                                                                                                                                                                                                                                    
if gender = . then delete;                                                                                                                                                                                                                                      
if gender = '' then delete;                                                                                                                                                                                                                                     
keep subject gender;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp02;  *no typos;                                                                                                                                                                                                                                        
set hi.combine;                                                                                                                                                                                                                                                 
if site = 0 then delete;                                                                                                                                                                                                                                        
if site = 1 then delete;                                                                                                                                                                                                                                        
if site = 2 then delete;                                                                                                                                                                                                                                        
if site = 3 then delete;                                                                                                                                                                                                                                        
if site = 4 then delete;                                                                                                                                                                                                                                        
if site = 5 then delete;                                                                                                                                                                                                                                        
if site = . then delete;                                                                                                                                                                                                                                        
keep subject site;                                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp03; * has typos besides 0 and 1;                                                                                                                                                                                                                       
set hi.combine;                                                                                                                                                                                                                                                 
if smoke = 0 then delete;                                                                                                                                                                                                                                       
if smoke = 1 then delete;                                                                                                                                                                                                                                       
if smoke = . then delete;                                                                                                                                                                                                                                       
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = temp03;                                                                                                                                                                                                                                       
title 'smoke typos';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp04;  *no typos;                                                                                                                                                                                                                                        
set hi.combine;                                                                                                                                                                                                                                                 
if drink = 0 then delete;                                                                                                                                                                                                                                       
if drink = 1 then delete;                                                                                                                                                                                                                                       
if drink = 2 then delete;                                                                                                                                                                                                                                       
if drink = 3 then delete;                                                                                                                                                                                                                                       
if drink = 4 then delete;                                                                                                                                                                                                                                       
if drink = 5 then delete;                                                                                                                                                                                                                                       
if drink = . then delete;                                                                                                                                                                                                                                       
keep subject drink;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp05;  *has typos besides 1,2,3,4;                                                                                                                                                                                                                       
set hi.combine;                                                                                                                                                                                                                                                 
if marital = 0 then delete;                                                                                                                                                                                                                                     
if marital = 1 then delete;                                                                                                                                                                                                                                     
if marital = 2 then delete;                                                                                                                                                                                                                                     
if marital = 3 then delete;                                                                                                                                                                                                                                     
if marital = 4 then delete;                                                                                                                                                                                                                                     
if marital = . then delete;                                                                                                                                                                                                                                     
keep subject marital;                                                                                                                                                                                                                                           
title 'marital typos';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
proc print data = temp05;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp06; *no typos;                                                                                                                                                                                                                                         
set hi.combine;                                                                                                                                                                                                                                                 
if education = 0 then delete;                                                                                                                                                                                                                                   
if education = 1 then delete;                                                                                                                                                                                                                                   
if education = 2 then delete;                                                                                                                                                                                                                                   
if education = 3 then delete;                                                                                                                                                                                                                                   
if education = 4 then delete;                                                                                                                                                                                                                                   
if education = . then delete;                                                                                                                                                                                                                                   
keep subject education;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp07; *no typos;                                                                                                                                                                                                                                         
set hi.combine;                                                                                                                                                                                                                                                 
if pregnancy = 0 then delete;                                                                                                                                                                                                                                   
if pregnancy = 1 then delete;                                                                                                                                                                                                                                   
if pregnancy = 9 then delete;                                                                                                                                                                                                                                   
if pregnancy = . then delete;                                                                                                                                                                                                                                   
keep subject pregnancy;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp08; *no typos;                                                                                                                                                                                                                                         
set hi.combine;                                                                                                                                                                                                                                                 
if exercise = 0 then delete;                                                                                                                                                                                                                                    
if exercise = 1 then delete;                                                                                                                                                                                                                                    
if exercise = . then delete;                                                                                                                                                                                                                                    
keep subject exercise;                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp09; *no typos;                                                                                                                                                                                                                                         
set hi.combine;                                                                                                                                                                                                                                                 
if chd = 0 then delete;                                                                                                                                                                                                                                         
if chd = 1 then delete;                                                                                                                                                                                                                                         
if chd = . then delete;                                                                                                                                                                                                                                         
keep subject chd;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*******************************seperate analysis by site********************************/                                                                                                                                                                      
                                                                                                                                                                                                                                                                
/******************************************Arizona*************************************************/                                                                                                                                                            
PROC PRINTTO PRINT='G:\rutgers\computing\project\AZ screening report.txt';                                                                                                                                                                                      
TITLE 'Arizona epi screening report';                                                                                                                                                                                                                           
RUN;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
DATA Arizona;                                                                                                                                                                                                                                                   
SET one;                                                                                                                                                                                                                                                        
IF site = 1;                                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc means data = Arizona;                                                                                                                                                                                                                                      
title 'Arizona_means_total';                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Arizona_set;                                                                                                                                                                                                                                               
set Arizona;                                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************missing data**************************/                                                                                                                                                                                           
data az_miss_dbp;                                                                                                                                                                                                                                               
set Arizona;                                                                                                                                                                                                                                                    
if dbp = .;                                                                                                                                                                                                                                                     
keep subject dbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_dbp;                                                                                                                                                                                                                                  
title 'az_miss_dbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_sbp;                                                                                                                                                                                                                                               
set Arizona;                                                                                                                                                                                                                                                    
if sbp = .;                                                                                                                                                                                                                                                     
keep subject sbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_sbp;                                                                                                                                                                                                                                  
title 'az_miss_sbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_dob;                                                                                                                                                                                                                                               
set Arizona;                                                                                                                                                                                                                                                    
if dob = .;                                                                                                                                                                                                                                                     
keep subject dob;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_dob;                                                                                                                                                                                                                                  
title 'az_miss_dob';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_doe;                                                                                                                                                                                                                                               
set Arizona;                                                                                                                                                                                                                                                    
if doe = .;                                                                                                                                                                                                                                                     
keep subject doe;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_doe;                                                                                                                                                                                                                                  
title 'az_miss_doe';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_smoke;                                                                                                                                                                                                                                             
set Arizona;                                                                                                                                                                                                                                                    
if smoke = .;                                                                                                                                                                                                                                                   
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_smoke;                                                                                                                                                                                                                                
title 'az_miss_smoke';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_drink;                                                                                                                                                                                                                                             
set Arizona;                                                                                                                                                                                                                                                    
if drink = .;                                                                                                                                                                                                                                                   
keep subject drink;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_drink;                                                                                                                                                                                                                                
title 'az_miss_drink';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_marital;                                                                                                                                                                                                                                           
set Arizona;                                                                                                                                                                                                                                                    
if marital = .;                                                                                                                                                                                                                                                 
keep subject marital;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_marital;                                                                                                                                                                                                                              
title 'az_miss_marital';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_education;                                                                                                                                                                                                                                         
set Arizona;                                                                                                                                                                                                                                                    
if education = .;                                                                                                                                                                                                                                               
keep subject education;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_education;                                                                                                                                                                                                                            
title 'az_miss_education';                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_glucose;                                                                                                                                                                                                                                           
set Arizona;                                                                                                                                                                                                                                                    
if glucose = .;                                                                                                                                                                                                                                                 
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_glucose;                                                                                                                                                                                                                              
title 'az_miss_glucose';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_tc;                                                                                                                                                                                                                                                
set Arizona;                                                                                                                                                                                                                                                    
if tc = .;                                                                                                                                                                                                                                                      
keep subject tc;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_tc;                                                                                                                                                                                                                                   
title 'az_miss_tc';                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data az_miss_age;                                                                                                                                                                                                                                               
set Arizona;                                                                                                                                                                                                                                                    
if age = .;                                                                                                                                                                                                                                                     
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_age;                                                                                                                                                                                                                                  
title 'az_miss_age';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data az_miss_gender;                                                                                                                                                                                                                                            
set Arizona;                                                                                                                                                                                                                                                    
if gender = 'M' then delete;                                                                                                                                                                                                                                    
if gender = 'F' then delete;                                                                                                                                                                                                                                    
keep subject gender;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
proc print data = az_miss_gender;                                                                                                                                                                                                                               
title 'az_miss_gender';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/**************************************Arizona checking input typos**************************/                                                                                                                                                                  
data temp11; * has typos besides 0 and 1;                                                                                                                                                                                                                       
set Arizona;                                                                                                                                                                                                                                                    
if smoke = 0 then delete;                                                                                                                                                                                                                                       
if smoke = 1 then delete;                                                                                                                                                                                                                                       
if smoke = . then delete;                                                                                                                                                                                                                                       
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = temp11;                                                                                                                                                                                                                                       
title 'AZ smoke typos';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp22;  *has typos besides 1,2,3,4;                                                                                                                                                                                                                       
set Arizona;                                                                                                                                                                                                                                                    
if marital = 0 then delete;                                                                                                                                                                                                                                     
if marital = 1 then delete;                                                                                                                                                                                                                                     
if marital = 2 then delete;                                                                                                                                                                                                                                     
if marital = 3 then delete;                                                                                                                                                                                                                                     
if marital = 4 then delete;                                                                                                                                                                                                                                     
if marital = . then delete;                                                                                                                                                                                                                                     
keep subject marital;                                                                                                                                                                                                                                           
title 'AZ marital typos';                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
proc print data = temp22;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/*****************************Height*************************************/                                                                                                                                                                                      
/*links:https://en.wikipedia.org/wiki/List_of_tallest_people;                                                                                                                                                                                                   
 *      http://www.sengpielaudio.com/calculator-bodylength.htm;                                                                                                                                                                                                 
 *United States      272 cm      107 inches which is not likely in our daily life                                                                                                                                                                               
 *Then we set 100 inches from the project example as the standart*/                                                                                                                                                                                             
data Arizona_height;                                                                                                                                                                                                                                            
set Arizona_set;                                                                                                                                                                                                                                                
if height>100 then output;                                                                                                                                                                                                                                      
keep subject height;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_height;                                                                                                                                                                                                                               
title 'AZ heights over 100 inches';                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*********glucose**********/                                                                                                                                                                                                                                    
*A normal fasting blood glucose target range for an individual without diabetes is 70-100 mg/dL (3.9-5.6 mmol/L). The American Diabetes Association recommends a fasting plasma glucose level of 70-130 mg/dL (3.9-7.2 mmol/L) and after meals less than 180 mg/
 mmol/L).;                                                                                                                                                                                                                                                      
*link:https://www.mayoclinic.org/diseases-conditions/diabetes/expert-blog/blood-glucose-target-range/bgp-20056575;                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data = Arizona_set;                                                                                                                                                                                                                                   
by descending glucose;                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Arizona_glucose1;                                                                                                                                                                                                                                          
set Arizona_set;                                                                                                                                                                                                                                                
if glucose > 250;                                                                                                                                                                                                                                               
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_glucose1;                                                                                                                                                                                                                             
title 'AZ glucose mearurement units error';                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/***********male&pregnancy***********/                                                                                                                                                                                                                          
proc sort data = Arizona_set;                                                                                                                                                                                                                                   
by gender pregnancy;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data Arizona_male_pregnancy;                                                                                                                                                                                                                                    
set Arizona_set;                                                                                                                                                                                                                                                
if gender = 'M' && pregnancy = 1;                                                                                                                                                                                                                               
keep subject gender pregnancy;                                                                                                                                                                                                                                  
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_male_pregnancy;                                                                                                                                                                                                                       
title 'AZ male&&pregnancy';                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/************sbp&&dbp*********/                                                                                                                                                                                                                                 
/*sbp normally is greater than dbp*/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Blood_pressure;                                                                                                                                                                                                            
Hypertensive urgency      sbp > 180    dbp > 110*/                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data= Arizona_set;                                                                                                                                                                                                                                    
by sbp dbp;                                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Arizona_sbp_dbp1;                                                                                                                                                                                                                                          
set Arizona_set;                                                                                                                                                                                                                                                
if dbp NE . && sbp NE . && dbp>sbp;  *avoid that sbp equals to period;                                                                                                                                                                                          
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_sbp_dbp1;                                                                                                                                                                                                                             
title 'AZ dbp greater than sbp';                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data Arizona_sbp_dbp2;                                                                                                                                                                                                                                          
set Arizona_set;                                                                                                                                                                                                                                                
if dbp>110 && sbp> 180;                                                                                                                                                                                                                                         
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_sbp_dbp2;                                                                                                                                                                                                                             
title 'AZ dbp > 110 && sbp > 180';                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/*************Age************/                                                                                                                                                                                                                                  
/*link:http://www.businessinsider.com/us-states-with-the-highest-and-lowest-life-expectancy-2017-5*/                                                                                                                                                            
/*set age over 90 is unusual*/                                                                                                                                                                                                                                  
proc sort data = Arizona_set;                                                                                                                                                                                                                                   
by descending age;                                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Arizona_age1;                                                                                                                                                                                                                                              
set Arizona_set;                                                                                                                                                                                                                                                
if age>90;                                                                                                                                                                                                                                                      
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_age1;                                                                                                                                                                                                                                 
title 'AZ Age unusual';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
*Elder who has normal blood pressure;                                                                                                                                                                                                                           
data Arizona_age2;                                                                                                                                                                                                                                              
set Arizona_set;                                                                                                                                                                                                                                                
if age >60 && age < 110 && sbp<120 && dbp<90;                                                                                                                                                                                                                   
keep subject age sbp dbp;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_age2;                                                                                                                                                                                                                                 
title 'AZ Elder normal blood pressure';                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/******************pregnant**************/                                                                                                                                                                                                                      
*At 45, a woman's likelihood of getting pregnant is no more than 3 or 4 percent.;                                                                                                                                                                               
*link:http://www.parents.com/getting-pregnant/trying-to-conceive/getting-pregnant-at-every-pregnancy-age/;                                                                                                                                                      
data Arizona_age3;                                                                                                                                                                                                                                              
set Arizona_set;                                                                                                                                                                                                                                                
if age>45 && pregnancy = 1;                                                                                                                                                                                                                                     
keep subject age pregnancy;                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
quit;                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************tc***************/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Triglyceride*/                                                                                                                                                                                                             
*500 or higher Very high - high risk;                                                                                                                                                                                                                           
data Arizona_tg;                                                                                                                                                                                                                                                
set Arizona_set;                                                                                                                                                                                                                                                
if tg>500;                                                                                                                                                                                                                                                      
keep subject tg;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Arizona_tg;                                                                                                                                                                                                                                   
title 'AZ unusual tg';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************ldl****************/                                                                                                                                                                                                                         
/*link:https://www.health.harvard.edu/heart-health/hdl-cholesterol-how-much-is-enough;                                                                                                                                                                          
 *Less than 100 mg/dL           Optimal                                                                                                                                                                                                                         
 *190 mg/dL and above           Very High                                                                                                                                                                                                                       
 *Then we consider that ldl over 190 is unusual*/                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                
data Arizona_ldl;                                                                                                                                                                                                                                               
set Arizona_set;                                                                                                                                                                                                                                                
if ldl>200 then output;                                                                                                                                                                                                                                         
keep subject ldl;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = Arizona_ldl;                                                                                                                                                                                                                                  
title 'AZ ldl over 200';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/********************************************California***************************************************/                                                                                                                                                     
PROC PRINTTO PRINT='G:\rutgers\computing\project\CA screening report.txt';                                                                                                                                                                                      
TITLE 'California epi screening report';                                                                                                                                                                                                                        
RUN;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
DATA California;                                                                                                                                                                                                                                                
SET two;                                                                                                                                                                                                                                                        
IF site = 2;                                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc means data = California;                                                                                                                                                                                                                                   
title 'California_means_total';                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data California_set;                                                                                                                                                                                                                                            
set California;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************CA_missing data**************************/                                                                                                                                                                                        
data ca_miss_dbp;                                                                                                                                                                                                                                               
set California;                                                                                                                                                                                                                                                 
if dbp = .;                                                                                                                                                                                                                                                     
keep subject dbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_dbp;                                                                                                                                                                                                                                  
title 'ca_miss_dbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_sbp;                                                                                                                                                                                                                                               
set California;                                                                                                                                                                                                                                                 
if sbp = .;                                                                                                                                                                                                                                                     
keep subject sbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_sbp;                                                                                                                                                                                                                                  
title 'ca_miss_sbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_dob;                                                                                                                                                                                                                                               
set California;                                                                                                                                                                                                                                                 
if dob = .;                                                                                                                                                                                                                                                     
keep subject dob;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_dob;                                                                                                                                                                                                                                  
title 'ca_miss_dob';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_doe;                                                                                                                                                                                                                                               
set California;                                                                                                                                                                                                                                                 
if doe = .;                                                                                                                                                                                                                                                     
keep subject doe;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_doe;                                                                                                                                                                                                                                  
title 'ca_miss_doe';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_smoke;                                                                                                                                                                                                                                             
set California;                                                                                                                                                                                                                                                 
if smoke = .;                                                                                                                                                                                                                                                   
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_smoke;                                                                                                                                                                                                                                
title 'ca_miss_smoke';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_drink;                                                                                                                                                                                                                                             
set California;                                                                                                                                                                                                                                                 
if drink = .;                                                                                                                                                                                                                                                   
keep subject drink;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_drink;                                                                                                                                                                                                                                
title 'ca_miss_drink';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_marital;                                                                                                                                                                                                                                           
set California;                                                                                                                                                                                                                                                 
if marital = .;                                                                                                                                                                                                                                                 
keep subject marital;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_marital;                                                                                                                                                                                                                              
title 'ca_miss_marital';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_education;                                                                                                                                                                                                                                         
set California;                                                                                                                                                                                                                                                 
if education = .;                                                                                                                                                                                                                                               
keep subject education;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_education;                                                                                                                                                                                                                            
title 'ca_miss_education';                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_glucose;                                                                                                                                                                                                                                           
set California;                                                                                                                                                                                                                                                 
if glucose = .;                                                                                                                                                                                                                                                 
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_glucose;                                                                                                                                                                                                                              
title 'ca_miss_glucose';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_tc;                                                                                                                                                                                                                                                
set California;                                                                                                                                                                                                                                                 
if tc = .;                                                                                                                                                                                                                                                      
keep subject tc;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_tc;                                                                                                                                                                                                                                   
title 'ca_miss_tc';                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data ca_miss_age;                                                                                                                                                                                                                                               
set California;                                                                                                                                                                                                                                                 
if age = .;                                                                                                                                                                                                                                                     
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_age;                                                                                                                                                                                                                                  
title 'ca_miss_age';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ca_miss_gender;                                                                                                                                                                                                                                            
set California;                                                                                                                                                                                                                                                 
if gender = 'M' then delete;                                                                                                                                                                                                                                    
if gender = 'F' then delete;                                                                                                                                                                                                                                    
keep subject gender;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
proc print data = ca_miss_gender;                                                                                                                                                                                                                               
title 'ca_miss_gender';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/**************************************California checking input typos**************************/                                                                                                                                                               
data temp111; * has typos besides 0 and 1;                                                                                                                                                                                                                      
set California;                                                                                                                                                                                                                                                 
if smoke = 0 then delete;                                                                                                                                                                                                                                       
if smoke = 1 then delete;                                                                                                                                                                                                                                       
if smoke = . then delete;                                                                                                                                                                                                                                       
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = temp111;                                                                                                                                                                                                                                      
title 'CA smoke typos';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp222;  *has typos besides 1,2,3,4;                                                                                                                                                                                                                      
set California;                                                                                                                                                                                                                                                 
if marital = 0 then delete;                                                                                                                                                                                                                                     
if marital = 1 then delete;                                                                                                                                                                                                                                     
if marital = 2 then delete;                                                                                                                                                                                                                                     
if marital = 3 then delete;                                                                                                                                                                                                                                     
if marital = 4 then delete;                                                                                                                                                                                                                                     
if marital = . then delete;                                                                                                                                                                                                                                     
keep subject marital;                                                                                                                                                                                                                                           
title 'CA marital typos';                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
proc print data = temp222;                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************Height*************************************/                                                                                                                                                                                      
/*links:https://en.wikipedia.org/wiki/List_of_tallest_people;                                                                                                                                                                                                   
 *      http://www.sengpielaudio.com/calculator-bodylength.htm;                                                                                                                                                                                                 
 *United States      272 cm      107 inches which is not likely in our daily life                                                                                                                                                                               
 *Then we set 100 inches from the project example as the standart*/                                                                                                                                                                                             
data California_height;                                                                                                                                                                                                                                         
set California_set;                                                                                                                                                                                                                                             
if height>100 then output;                                                                                                                                                                                                                                      
keep subject height;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_height;                                                                                                                                                                                                                            
title 'CA heights over 100 inches';                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*********glucose**********/                                                                                                                                                                                                                                    
*A normal fasting blood glucose target range for an individual without diabetes is 70-100 mg/dL (3.9-5.6 mmol/L). The American Diabetes Association recommends a fasting plasma glucose level of 70-130 mg/dL (3.9-7.2 mmol/L) and after meals less than 180 mg/
 mmol/L).;                                                                                                                                                                                                                                                      
*link:https://www.mayoclinic.org/diseases-conditions/diabetes/expert-blog/blood-glucose-target-range/bgp-20056575;                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data = California_set;                                                                                                                                                                                                                                
by descending glucose;                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data California_glucose1;                                                                                                                                                                                                                                       
set California_set;                                                                                                                                                                                                                                             
if glucose > 250;                                                                                                                                                                                                                                               
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_glucose1;                                                                                                                                                                                                                          
title 'CA glucose measurement units error';                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/***********male&pregnancy***********/                                                                                                                                                                                                                          
proc sort data = California_set;                                                                                                                                                                                                                                
by gender pregnancy;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data California_male_pregnancy;                                                                                                                                                                                                                                 
set California_set;                                                                                                                                                                                                                                             
if gender = 'M' && pregnancy = 1;                                                                                                                                                                                                                               
keep subject gender pregnancy;                                                                                                                                                                                                                                  
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_male_pregnancy;                                                                                                                                                                                                                    
title 'CA male&&pregnancy';                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/************sbp&&dbp*********/                                                                                                                                                                                                                                 
/*sbp normally is greater than dbp*/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Blood_pressure;                                                                                                                                                                                                            
Hypertensive urgency      sbp > 180    dbp > 110*/                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data= California_set;                                                                                                                                                                                                                                 
by sbp dbp;                                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data California_sbp_dbp1;                                                                                                                                                                                                                                       
set California_set;                                                                                                                                                                                                                                             
if dbp NE . && sbp NE . && dbp>sbp;  *avoid that sbp equals to period;                                                                                                                                                                                          
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_sbp_dbp1;                                                                                                                                                                                                                          
title 'CA dbp greater than sbp';                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data California_sbp_dbp2;                                                                                                                                                                                                                                       
set California_set;                                                                                                                                                                                                                                             
if dbp>110 && sbp> 180;                                                                                                                                                                                                                                         
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_sbp_dbp2;                                                                                                                                                                                                                          
title 'CA dbp > 110 && sbp > 180';                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/*************Age************/                                                                                                                                                                                                                                  
/*link:http://www.businessinsider.com/us-states-with-the-highest-and-lowest-life-expectancy-2017-5*/                                                                                                                                                            
/*set age over 90 is unusual*/                                                                                                                                                                                                                                  
proc sort data = California_set;                                                                                                                                                                                                                                
by descending age;                                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data California_age1;                                                                                                                                                                                                                                           
set California_set;                                                                                                                                                                                                                                             
if age>90;                                                                                                                                                                                                                                                      
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_age1;                                                                                                                                                                                                                              
title 'CA Age unusual';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
*Elder who has normal blood pressure;                                                                                                                                                                                                                           
data California_age2;                                                                                                                                                                                                                                           
set California_set;                                                                                                                                                                                                                                             
if age >60 && age < 110 && sbp<120 && dbp<90;                                                                                                                                                                                                                   
keep subject age sbp dbp;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_age2;                                                                                                                                                                                                                              
title 'CA Elder normal blood pressure';                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************pregnant*************/                                                                                                                                                                                                                       
*At 45, a woman's likelihood of getting pregnant is no more than 3 or 4 percent.;                                                                                                                                                                               
*link:http://www.parents.com/getting-pregnant/trying-to-conceive/getting-pregnant-at-every-pregnancy-age/;                                                                                                                                                      
data California_age3;                                                                                                                                                                                                                                           
set California_set;                                                                                                                                                                                                                                             
if age>45 && pregnancy = 1;                                                                                                                                                                                                                                     
keep subject age pregnancy;                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
quit;                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************tc***************/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Triglyceride*/                                                                                                                                                                                                             
*500 or higher Very high - high risk;                                                                                                                                                                                                                           
data California_tg;                                                                                                                                                                                                                                             
set California_set;                                                                                                                                                                                                                                             
if tg>500;                                                                                                                                                                                                                                                      
keep subject tg;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = California_tg;                                                                                                                                                                                                                                
title 'CA unusual tg';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************ldl****************/                                                                                                                                                                                                                         
/*link:https://www.health.harvard.edu/heart-health/hdl-cholesterol-how-much-is-enough;                                                                                                                                                                          
 *Less than 100 mg/dL           Optimal                                                                                                                                                                                                                         
 *190 mg/dL and above           Very High                                                                                                                                                                                                                       
 *Then we consider that ldl over 190 is unusual*/                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                
data California_ldl;                                                                                                                                                                                                                                            
set California_set;                                                                                                                                                                                                                                             
if ldl>200 then output;                                                                                                                                                                                                                                         
keep subject ldl;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = California_ldl;                                                                                                                                                                                                                               
title 'CA ldl over 200';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/********************************************New_Jersey********************************************/                                                                                                                                                            
PROC PRINTTO PRINT='G:\rutgers\computing\project\NJ screening report.txt';                                                                                                                                                                                      
TITLE 'New_Jersey epi screening report';                                                                                                                                                                                                                        
RUN;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
DATA New_Jersey;                                                                                                                                                                                                                                                
SET three;                                                                                                                                                                                                                                                      
IF site = 3;                                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc means data = New_Jersey;                                                                                                                                                                                                                                   
title 'New_Jersey_means_total';                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_Jersey_set;                                                                                                                                                                                                                                            
set New_Jersey;                                                                                                                                                                                                                                                 
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************NJ_missing data**************************/                                                                                                                                                                                        
data nj_miss_dbp;                                                                                                                                                                                                                                               
set New_Jersey;                                                                                                                                                                                                                                                 
if dbp = .;                                                                                                                                                                                                                                                     
keep subject dbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_dbp;                                                                                                                                                                                                                                  
title 'nj_miss_dbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_sbp;                                                                                                                                                                                                                                               
set New_Jersey;                                                                                                                                                                                                                                                 
if sbp = .;                                                                                                                                                                                                                                                     
keep subject sbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_sbp;                                                                                                                                                                                                                                  
title 'nj_miss_sbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_dob;                                                                                                                                                                                                                                               
set New_Jersey;                                                                                                                                                                                                                                                 
if dob = .;                                                                                                                                                                                                                                                     
keep subject dob;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_dob;                                                                                                                                                                                                                                  
title 'nj_miss_dob';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_doe;                                                                                                                                                                                                                                               
set New_Jersey;                                                                                                                                                                                                                                                 
if doe = .;                                                                                                                                                                                                                                                     
keep subject doe;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_doe;                                                                                                                                                                                                                                  
title 'nj_miss_doe';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_smoke;                                                                                                                                                                                                                                             
set New_Jersey;                                                                                                                                                                                                                                                 
if smoke = .;                                                                                                                                                                                                                                                   
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_smoke;                                                                                                                                                                                                                                
title 'nj_miss_smoke';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_drink;                                                                                                                                                                                                                                             
set New_Jersey;                                                                                                                                                                                                                                                 
if drink = .;                                                                                                                                                                                                                                                   
keep subject drink;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_drink;                                                                                                                                                                                                                                
title 'nj_miss_drink';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_marital;                                                                                                                                                                                                                                           
set New_Jersey;                                                                                                                                                                                                                                                 
if marital = .;                                                                                                                                                                                                                                                 
keep subject marital;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_marital;                                                                                                                                                                                                                              
title 'nj_miss_marital';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_edunjtion;                                                                                                                                                                                                                                         
set New_Jersey;                                                                                                                                                                                                                                                 
if edunjtion = .;                                                                                                                                                                                                                                               
keep subject edunjtion;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_edunjtion;                                                                                                                                                                                                                            
title 'nj_miss_edunjtion';                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_glucose;                                                                                                                                                                                                                                           
set New_Jersey;                                                                                                                                                                                                                                                 
if glucose = .;                                                                                                                                                                                                                                                 
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_glucose;                                                                                                                                                                                                                              
title 'nj_miss_glucose';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_tc;                                                                                                                                                                                                                                                
set New_Jersey;                                                                                                                                                                                                                                                 
if tc = .;                                                                                                                                                                                                                                                      
keep subject tc;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_tc;                                                                                                                                                                                                                                   
title 'nj_miss_tc';                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data nj_miss_age;                                                                                                                                                                                                                                               
set New_Jersey;                                                                                                                                                                                                                                                 
if age = .;                                                                                                                                                                                                                                                     
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_age;                                                                                                                                                                                                                                  
title 'nj_miss_age';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data nj_miss_gender;                                                                                                                                                                                                                                            
set New_Jersey;                                                                                                                                                                                                                                                 
if gender = 'M' then delete;                                                                                                                                                                                                                                    
if gender = 'F' then delete;                                                                                                                                                                                                                                    
keep subject gender;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
proc print data = nj_miss_gender;                                                                                                                                                                                                                               
title 'nj_miss_gender';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/**************************************New_Jersey checking input typos**************************/                                                                                                                                                               
data temp1111; * has typos besides 0 and 1;                                                                                                                                                                                                                     
set New_Jersey;                                                                                                                                                                                                                                                 
if smoke = 0 then delete;                                                                                                                                                                                                                                       
if smoke = 1 then delete;                                                                                                                                                                                                                                       
if smoke = . then delete;                                                                                                                                                                                                                                       
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = temp1111;                                                                                                                                                                                                                                     
title 'NJ smoke typos';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp2222;  *has typos besides 1,2,3,4;                                                                                                                                                                                                                     
set New_Jersey;                                                                                                                                                                                                                                                 
if marital = 0 then delete;                                                                                                                                                                                                                                     
if marital = 1 then delete;                                                                                                                                                                                                                                     
if marital = 2 then delete;                                                                                                                                                                                                                                     
if marital = 3 then delete;                                                                                                                                                                                                                                     
if marital = 4 then delete;                                                                                                                                                                                                                                     
if marital = . then delete;                                                                                                                                                                                                                                     
keep subject marital;                                                                                                                                                                                                                                           
title 'NJ marital typos';                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
proc print data = temp2222;                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************Height*************************************/                                                                                                                                                                                      
/*links:https://en.wikipedia.org/wiki/List_of_tallest_people;                                                                                                                                                                                                   
 *      http://www.sengpielaudio.com/calculator-bodylength.htm;                                                                                                                                                                                                 
 *United States      272 cm      107 inches which is not likely in our daily life                                                                                                                                                                               
 *Then we set 100 inches from the project example as the standart*/                                                                                                                                                                                             
data New_Jersey_height;                                                                                                                                                                                                                                         
set New_Jersey_set;                                                                                                                                                                                                                                             
if height>100 then output;                                                                                                                                                                                                                                      
keep subject height;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_height;                                                                                                                                                                                                                            
title 'NJ heights over 100 inches';                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*********glucose**********/                                                                                                                                                                                                                                    
*A normal fasting blood glucose target range for an individual without diabetes is 70-100 mg/dL (3.9-5.6 mmol/L). The American Diabetes Association recommends a fasting plasma glucose level of 70-130 mg/dL (3.9-7.2 mmol/L) and after meals less than 180 mg/
 mmol/L).;                                                                                                                                                                                                                                                      
*link:https://www.mayoclinic.org/diseases-conditions/diabetes/expert-blog/blood-glucose-target-range/bgp-20056575;                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data = New_Jersey_set;                                                                                                                                                                                                                                
by descending glucose;                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_Jersey_glucose1;                                                                                                                                                                                                                                       
set New_Jersey_set;                                                                                                                                                                                                                                             
if glucose > 250;                                                                                                                                                                                                                                               
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_glucose1;                                                                                                                                                                                                                          
title 'NJ glucose measurement units error';                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/***********male&pregnancy***********/                                                                                                                                                                                                                          
proc sort data = New_Jersey_set;                                                                                                                                                                                                                                
by gender pregnancy;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_Jersey_male_pregnancy;                                                                                                                                                                                                                                 
set New_Jersey_set;                                                                                                                                                                                                                                             
if gender = 'M' && pregnancy = 1;                                                                                                                                                                                                                               
keep subject gender pregnancy;                                                                                                                                                                                                                                  
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_male_pregnancy;                                                                                                                                                                                                                    
title 'NJ male&&pregnancy';                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/************sbp&&dbp*********/                                                                                                                                                                                                                                 
/*sbp normally is greater than dbp*/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Blood_pressure;                                                                                                                                                                                                            
Hypertensive urgency      sbp > 180    dbp > 110*/                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data= New_Jersey_set;                                                                                                                                                                                                                                 
by sbp dbp;                                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_Jersey_sbp_dbp1;                                                                                                                                                                                                                                       
set New_Jersey_set;                                                                                                                                                                                                                                             
if dbp NE . && sbp NE . && dbp>sbp;  *avoid that sbp equals to period;                                                                                                                                                                                          
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_sbp_dbp1;                                                                                                                                                                                                                          
title 'NJ dbp greater than sbp';                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data New_Jersey_sbp_dbp2;                                                                                                                                                                                                                                       
set New_Jersey_set;                                                                                                                                                                                                                                             
if dbp>110 && sbp> 180;                                                                                                                                                                                                                                         
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_sbp_dbp2;                                                                                                                                                                                                                          
title 'NJ dbp > 110 && sbp > 180';                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/*************Age************/                                                                                                                                                                                                                                  
/*link:http://www.businessinsider.com/us-states-with-the-highest-and-lowest-life-expectancy-2017-5*/                                                                                                                                                            
/*set age over 90 is unusual*/                                                                                                                                                                                                                                  
proc sort data = New_Jersey_set;                                                                                                                                                                                                                                
by descending age;                                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_Jersey_age1;                                                                                                                                                                                                                                           
set New_Jersey_set;                                                                                                                                                                                                                                             
if age>90;                                                                                                                                                                                                                                                      
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_age1;                                                                                                                                                                                                                              
title 'NJ Age unusual';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
*Elder who has normal blood pressure;                                                                                                                                                                                                                           
data New_Jersey_age2;                                                                                                                                                                                                                                           
set New_Jersey_set;                                                                                                                                                                                                                                             
if age >60 && age < 110 && sbp<120 && dbp<90;                                                                                                                                                                                                                   
keep subject age sbp dbp;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_age2;                                                                                                                                                                                                                              
title 'NJ Elder normal blood pressure';                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************pregnant*************/                                                                                                                                                                                                                       
*At 45, a woman's likelihood of getting pregnant is no more than 3 or 4 percent.;                                                                                                                                                                               
*link:http://www.parents.com/getting-pregnant/trying-to-conceive/getting-pregnant-at-every-pregnancy-age/;                                                                                                                                                      
data New_Jersey_age3;                                                                                                                                                                                                                                           
set New_Jersey_set;                                                                                                                                                                                                                                             
if age>45 && pregnancy = 1;                                                                                                                                                                                                                                     
keep subject age pregnancy;                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************tc***************/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Triglyceride*/                                                                                                                                                                                                             
*500 or higher Very high - high risk;                                                                                                                                                                                                                           
data New_Jersey_tg;                                                                                                                                                                                                                                             
set New_Jersey_set;                                                                                                                                                                                                                                             
if tg>500;                                                                                                                                                                                                                                                      
keep subject tg;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_Jersey_tg;                                                                                                                                                                                                                                
title 'NJ unusual tg';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/******************ldl****************/                                                                                                                                                                                                                         
/*link:https://www.health.harvard.edu/heart-health/hdl-cholesterol-how-much-is-enough;                                                                                                                                                                          
 *Less than 100 mg/dL           Optimal                                                                                                                                                                                                                         
 *190 mg/dL and above           Very High                                                                                                                                                                                                                       
 *Then we consider that ldl over 190 is unusual*/                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                
data New_Jersey_ldl;                                                                                                                                                                                                                                            
set New_Jersey_set;                                                                                                                                                                                                                                             
if ldl>200 then output;                                                                                                                                                                                                                                         
keep subject ldl;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = New_Jersey_ldl;                                                                                                                                                                                                                               
title 'NJ ldl over 200';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/**************************************************New_York***********************************************************/                                                                                                                                         
PROC PRINTTO PRINT='G:\rutgers\computing\project\NY screening report.txt';                                                                                                                                                                                      
TITLE 'New_York epi screening report';                                                                                                                                                                                                                          
RUN;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
DATA New_York;                                                                                                                                                                                                                                                  
SET four;                                                                                                                                                                                                                                                       
IF site = 4;                                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc means data = New_York;                                                                                                                                                                                                                                     
title 'New_York_means_total';                                                                                                                                                                                                                                   
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_York_set;                                                                                                                                                                                                                                              
set New_York;                                                                                                                                                                                                                                                   
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************NY_missing data**************************/                                                                                                                                                                                        
data ny_miss_dbp;                                                                                                                                                                                                                                               
set New_York;                                                                                                                                                                                                                                                   
if dbp = .;                                                                                                                                                                                                                                                     
keep subject dbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_dbp;                                                                                                                                                                                                                                  
title 'ny_miss_dbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_sbp;                                                                                                                                                                                                                                               
set New_York;                                                                                                                                                                                                                                                   
if sbp = .;                                                                                                                                                                                                                                                     
keep subject sbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_sbp;                                                                                                                                                                                                                                  
title 'ny_miss_sbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_dob;                                                                                                                                                                                                                                               
set New_York;                                                                                                                                                                                                                                                   
if dob = .;                                                                                                                                                                                                                                                     
keep subject dob;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_dob;                                                                                                                                                                                                                                  
title 'ny_miss_dob';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_doe;                                                                                                                                                                                                                                               
set New_York;                                                                                                                                                                                                                                                   
if doe = .;                                                                                                                                                                                                                                                     
keep subject doe;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_doe;                                                                                                                                                                                                                                  
title 'ny_miss_doe';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_smoke;                                                                                                                                                                                                                                             
set New_York;                                                                                                                                                                                                                                                   
if smoke = .;                                                                                                                                                                                                                                                   
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_smoke;                                                                                                                                                                                                                                
title 'ny_miss_smoke';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_drink;                                                                                                                                                                                                                                             
set New_York;                                                                                                                                                                                                                                                   
if drink = .;                                                                                                                                                                                                                                                   
keep subject drink;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_drink;                                                                                                                                                                                                                                
title 'ny_miss_drink';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_marital;                                                                                                                                                                                                                                           
set New_York;                                                                                                                                                                                                                                                   
if marital = .;                                                                                                                                                                                                                                                 
keep subject marital;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_marital;                                                                                                                                                                                                                              
title 'ny_miss_marital';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_edunytion;                                                                                                                                                                                                                                         
set New_York;                                                                                                                                                                                                                                                   
if edunytion = .;                                                                                                                                                                                                                                               
keep subject edunytion;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_edunytion;                                                                                                                                                                                                                            
title 'ny_miss_edunytion';                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_glucose;                                                                                                                                                                                                                                           
set New_York;                                                                                                                                                                                                                                                   
if glucose = .;                                                                                                                                                                                                                                                 
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_glucose;                                                                                                                                                                                                                              
title 'ny_miss_glucose';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_tc;                                                                                                                                                                                                                                                
set New_York;                                                                                                                                                                                                                                                   
if tc = .;                                                                                                                                                                                                                                                      
keep subject tc;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_tc;                                                                                                                                                                                                                                   
title 'ny_miss_tc';                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data ny_miss_age;                                                                                                                                                                                                                                               
set New_York;                                                                                                                                                                                                                                                   
if age = .;                                                                                                                                                                                                                                                     
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_age;                                                                                                                                                                                                                                  
title 'ny_miss_age';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data ny_miss_gender;                                                                                                                                                                                                                                            
set New_York;                                                                                                                                                                                                                                                   
if gender = 'M' then delete;                                                                                                                                                                                                                                    
if gender = 'F' then delete;                                                                                                                                                                                                                                    
keep subject gender;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
proc print data = ny_miss_gender;                                                                                                                                                                                                                               
title 'ny_miss_gender';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/**************************************New_York checking input typos**************************/                                                                                                                                                                 
data temp11111; * has typos besides 0 and 1;                                                                                                                                                                                                                    
set New_York;                                                                                                                                                                                                                                                   
if smoke = 0 then delete;                                                                                                                                                                                                                                       
if smoke = 1 then delete;                                                                                                                                                                                                                                       
if smoke = . then delete;                                                                                                                                                                                                                                       
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = temp11111;                                                                                                                                                                                                                                    
title 'NY smoke typos';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp22222;  *has typos besides 1,2,3,4;                                                                                                                                                                                                                    
set New_York;                                                                                                                                                                                                                                                   
if marital = 0 then delete;                                                                                                                                                                                                                                     
if marital = 1 then delete;                                                                                                                                                                                                                                     
if marital = 2 then delete;                                                                                                                                                                                                                                     
if marital = 3 then delete;                                                                                                                                                                                                                                     
if marital = 4 then delete;                                                                                                                                                                                                                                     
if marital = . then delete;                                                                                                                                                                                                                                     
keep subject marital;                                                                                                                                                                                                                                           
title 'NY marital typos';                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
proc print data = temp22222;                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************Height*************************************/                                                                                                                                                                                      
/*links:https://en.wikipedia.org/wiki/List_of_tallest_people;                                                                                                                                                                                                   
 *      http://www.sengpielaudio.com/calculator-bodylength.htm;                                                                                                                                                                                                 
 *United States      272 cm      107 inches which is not likely in our daily life                                                                                                                                                                               
 *Then we set 100 inches from the project example as the standart*/                                                                                                                                                                                             
data New_York_height;                                                                                                                                                                                                                                           
set New_York_set;                                                                                                                                                                                                                                               
if height>100 then output;                                                                                                                                                                                                                                      
keep subject height;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_height;                                                                                                                                                                                                                              
title 'NY heights over 100 inches';                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*********glucose**********/                                                                                                                                                                                                                                    
*A normal fasting blood glucose target range for an individual without diabetes is 70-100 mg/dL (3.9-5.6 mmol/L). The American Diabetes Association recommends a fasting plasma glucose level of 70-130 mg/dL (3.9-7.2 mmol/L) and after meals less than 180 mg/
 mmol/L).;                                                                                                                                                                                                                                                      
*link:https://www.mayoclinic.org/diseases-conditions/diabetes/expert-blog/blood-glucose-target-range/bgp-20056575;                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data = New_York_set;                                                                                                                                                                                                                                  
by descending glucose;                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_York_glucose1;                                                                                                                                                                                                                                         
set New_York_set;                                                                                                                                                                                                                                               
if glucose > 250;                                                                                                                                                                                                                                               
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_glucose1;                                                                                                                                                                                                                            
title 'NY glucose measurement units error';                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/***********male&pregnancy***********/                                                                                                                                                                                                                          
proc sort data = New_York_set;                                                                                                                                                                                                                                  
by gender pregnancy;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data New_York_male_pregnancy;                                                                                                                                                                                                                                   
set New_York_set;                                                                                                                                                                                                                                               
if gender = 'M' && pregnancy = 1;                                                                                                                                                                                                                               
keep subject gender pregnancy;                                                                                                                                                                                                                                  
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_male_pregnancy;                                                                                                                                                                                                                      
title 'NY male&&pregnancy';                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/************sbp&&dbp*********/                                                                                                                                                                                                                                 
/*sbp normally is greater than dbp*/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Blood_pressure;                                                                                                                                                                                                            
Hypertensive urgency      sbp > 180    dbp > 110*/                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data= New_York_set;                                                                                                                                                                                                                                   
by sbp dbp;                                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_York_sbp_dbp1;                                                                                                                                                                                                                                         
set New_York_set;                                                                                                                                                                                                                                               
if dbp NE . && sbp NE . && dbp>sbp;  *avoid that sbp equals to period;                                                                                                                                                                                          
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_sbp_dbp1;                                                                                                                                                                                                                            
title 'NY dbp greater than sbp';                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data New_York_sbp_dbp2;                                                                                                                                                                                                                                         
set New_York_set;                                                                                                                                                                                                                                               
if dbp>110 && sbp> 180;                                                                                                                                                                                                                                         
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_sbp_dbp2;                                                                                                                                                                                                                            
title 'NY dbp > 110 && sbp > 180';                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/*************Age************/                                                                                                                                                                                                                                  
/*link:http://www.businessinsider.com/us-states-with-the-highest-and-lowest-life-expectancy-2017-5*/                                                                                                                                                            
/*set age over 90 is unusual*/                                                                                                                                                                                                                                  
proc sort data = New_York_set;                                                                                                                                                                                                                                  
by descending age;                                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data New_York_age1;                                                                                                                                                                                                                                             
set New_York_set;                                                                                                                                                                                                                                               
if age>90;                                                                                                                                                                                                                                                      
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_age1;                                                                                                                                                                                                                                
title 'NY Age unusual';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
*Elder who has normal blood pressure;                                                                                                                                                                                                                           
data New_York_age2;                                                                                                                                                                                                                                             
set New_York_set;                                                                                                                                                                                                                                               
if age >60 && age < 110 && sbp<120 && dbp<90;                                                                                                                                                                                                                   
keep subject age sbp dbp;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_age2;                                                                                                                                                                                                                                
title 'NY Elder normal blood pressure';                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************pregnant*************/                                                                                                                                                                                                                       
*At 45, a woman's likelihood of getting pregnant is no more than 3 or 4 percent.;                                                                                                                                                                               
*link:http://www.parents.com/getting-pregnant/trying-to-conceive/getting-pregnant-at-every-pregnancy-age/;                                                                                                                                                      
data New_York_age3;                                                                                                                                                                                                                                             
set New_York_set;                                                                                                                                                                                                                                               
if age>45 && pregnancy = 1;                                                                                                                                                                                                                                     
keep subject age pregnancy;                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************tc***************/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Triglyceride*/                                                                                                                                                                                                             
*500 or higher Very high - high risk;                                                                                                                                                                                                                           
data New_York_tg;                                                                                                                                                                                                                                               
set New_York_set;                                                                                                                                                                                                                                               
if tg>500;                                                                                                                                                                                                                                                      
keep subject tg;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = New_York_tg;                                                                                                                                                                                                                                  
title 'NY unusual tg';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/******************ldl****************/                                                                                                                                                                                                                         
/*link:https://www.health.harvard.edu/heart-health/hdl-cholesterol-how-much-is-enough;                                                                                                                                                                          
 *Less than 100 mg/dL           Optimal                                                                                                                                                                                                                         
 *190 mg/dL and above           Very High                                                                                                                                                                                                                       
 *Then we consider that ldl over 190 is unusual*/                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                
data New_York_ldl;                                                                                                                                                                                                                                              
set New_York_set;                                                                                                                                                                                                                                               
if ldl>200 then output;                                                                                                                                                                                                                                         
keep subject ldl;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = New_York_ldl;                                                                                                                                                                                                                                 
title 'NY ldl over 200';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/***********************************************Texas*******************************************/                                                                                                                                                               
PROC PRINTTO PRINT='G:\rutgers\computing\project\TX screening report.txt';                                                                                                                                                                                      
TITLE 'Texas epi screening report';                                                                                                                                                                                                                             
RUN;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
DATA Texas;                                                                                                                                                                                                                                                     
SET five;                                                                                                                                                                                                                                                       
IF site = 5;                                                                                                                                                                                                                                                    
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc means data = Texas;                                                                                                                                                                                                                                        
title 'Texas_means_total';                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Texas_set;                                                                                                                                                                                                                                                 
set Texas;                                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************TX_missing data**************************/                                                                                                                                                                                        
data tx_miss_dbp;                                                                                                                                                                                                                                               
set Texas;                                                                                                                                                                                                                                                      
if dbp = .;                                                                                                                                                                                                                                                     
keep subject dbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_dbp;                                                                                                                                                                                                                                  
title 'tx_miss_dbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_sbp;                                                                                                                                                                                                                                               
set Texas;                                                                                                                                                                                                                                                      
if sbp = .;                                                                                                                                                                                                                                                     
keep subject sbp;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_sbp;                                                                                                                                                                                                                                  
title 'tx_miss_sbp';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_dob;                                                                                                                                                                                                                                               
set Texas;                                                                                                                                                                                                                                                      
if dob = .;                                                                                                                                                                                                                                                     
keep subject dob;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_dob;                                                                                                                                                                                                                                  
title 'tx_miss_dob';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_doe;                                                                                                                                                                                                                                               
set Texas;                                                                                                                                                                                                                                                      
if doe = .;                                                                                                                                                                                                                                                     
keep subject doe;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_doe;                                                                                                                                                                                                                                  
title 'tx_miss_doe';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_smoke;                                                                                                                                                                                                                                             
set Texas;                                                                                                                                                                                                                                                      
if smoke = .;                                                                                                                                                                                                                                                   
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_smoke;                                                                                                                                                                                                                                
title 'tx_miss_smoke';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_drink;                                                                                                                                                                                                                                             
set Texas;                                                                                                                                                                                                                                                      
if drink = .;                                                                                                                                                                                                                                                   
keep subject drink;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_drink;                                                                                                                                                                                                                                
title 'tx_miss_drink';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_marital;                                                                                                                                                                                                                                           
set Texas;                                                                                                                                                                                                                                                      
if marital = .;                                                                                                                                                                                                                                                 
keep subject marital;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_marital;                                                                                                                                                                                                                              
title 'tx_miss_marital';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_edutxtion;                                                                                                                                                                                                                                         
set Texas;                                                                                                                                                                                                                                                      
if edutxtion = .;                                                                                                                                                                                                                                               
keep subject edutxtion;                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_edutxtion;                                                                                                                                                                                                                            
title 'tx_miss_edutxtion';                                                                                                                                                                                                                                      
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_glucose;                                                                                                                                                                                                                                           
set Texas;                                                                                                                                                                                                                                                      
if glucose = .;                                                                                                                                                                                                                                                 
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_glucose;                                                                                                                                                                                                                              
title 'tx_miss_glucose';                                                                                                                                                                                                                                        
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_tc;                                                                                                                                                                                                                                                
set Texas;                                                                                                                                                                                                                                                      
if tc = .;                                                                                                                                                                                                                                                      
keep subject tc;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_tc;                                                                                                                                                                                                                                   
title 'tx_miss_tc';                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data tx_miss_age;                                                                                                                                                                                                                                               
set Texas;                                                                                                                                                                                                                                                      
if age = .;                                                                                                                                                                                                                                                     
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_age;                                                                                                                                                                                                                                  
title 'tx_miss_age';                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data tx_miss_gender;                                                                                                                                                                                                                                            
set Texas;                                                                                                                                                                                                                                                      
if gender = 'M' then delete;                                                                                                                                                                                                                                    
if gender = 'F' then delete;                                                                                                                                                                                                                                    
keep subject gender;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
proc print data = tx_miss_gender;                                                                                                                                                                                                                               
title 'tx_miss_gender';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/**************************************Texas checking input typos**************************/                                                                                                                                                                    
data temp111111; * has typos besides 0 and 1;                                                                                                                                                                                                                   
set Texas;                                                                                                                                                                                                                                                      
if smoke = 0 then delete;                                                                                                                                                                                                                                       
if smoke = 1 then delete;                                                                                                                                                                                                                                       
if smoke = . then delete;                                                                                                                                                                                                                                       
keep subject smoke;                                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
proc print data = temp111111;                                                                                                                                                                                                                                   
title 'TX smoke typos';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data temp222222;  *has typos besides 1,2,3,4;                                                                                                                                                                                                                   
set Texas;                                                                                                                                                                                                                                                      
if marital = 0 then delete;                                                                                                                                                                                                                                     
if marital = 1 then delete;                                                                                                                                                                                                                                     
if marital = 2 then delete;                                                                                                                                                                                                                                     
if marital = 3 then delete;                                                                                                                                                                                                                                     
if marital = 4 then delete;                                                                                                                                                                                                                                     
if marital = . then delete;                                                                                                                                                                                                                                     
keep subject marital;                                                                                                                                                                                                                                           
title 'TX marital typos';                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
proc print data = temp222222;                                                                                                                                                                                                                                   
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************************Height*************************************/                                                                                                                                                                                      
/*links:https://en.wikipedia.org/wiki/List_of_tallest_people;                                                                                                                                                                                                   
 *      http://www.sengpielaudio.com/calculator-bodylength.htm;                                                                                                                                                                                                 
 *United States      272 cm      107 inches which is not likely in our daily life                                                                                                                                                                               
 *Then we set 100 inches from the project example as the standart*/                                                                                                                                                                                             
data Texas_height;                                                                                                                                                                                                                                              
set Texas_set;                                                                                                                                                                                                                                                  
if height>100 then output;                                                                                                                                                                                                                                      
keep subject height;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_height;                                                                                                                                                                                                                                 
title 'TX heights over 100 inches';                                                                                                                                                                                                                             
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc print data = Texas_height;                                                                                                                                                                                                                                 
title 'TX heights over 90 inches';                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/*********glucose**********/                                                                                                                                                                                                                                    
*A normal fasting blood glucose target range for an individual without diabetes is 70-100 mg/dL (3.9-5.6 mmol/L). The American Diabetes Association recommends a fasting plasma glucose level of 70-130 mg/dL (3.9-7.2 mmol/L) and after meals less than 180 mg/
 mmol/L).;                                                                                                                                                                                                                                                      
*link:https://www.mayoclinic.org/diseases-conditions/diabetes/expert-blog/blood-glucose-target-range/bgp-20056575;                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data = Texas_set;                                                                                                                                                                                                                                     
by descending glucose;                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Texas_glucose1;                                                                                                                                                                                                                                            
set Texas_set;                                                                                                                                                                                                                                                  
if glucose > 250;                                                                                                                                                                                                                                               
keep subject glucose;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_glucose1;                                                                                                                                                                                                                               
title 'TX glucose measurement units error';                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/***********male&pregnant***********/                                                                                                                                                                                                                           
proc sort data = Texas_set;                                                                                                                                                                                                                                     
by gender pregnancy;                                                                                                                                                                                                                                            
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data Texas_male_pregnancy;                                                                                                                                                                                                                                      
set Texas_set;                                                                                                                                                                                                                                                  
if gender = 'M' && pregnancy = 1;                                                                                                                                                                                                                               
keep subject gender pregnancy;                                                                                                                                                                                                                                  
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_male_pregnancy;                                                                                                                                                                                                                         
title 'TX male&&pregnancy';                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
/************sbp&&dbp*********/                                                                                                                                                                                                                                 
/*sbp normally is greater than dbp*/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Blood_pressure;                                                                                                                                                                                                            
Hypertensive urgency      sbp > 180    dbp > 110*/                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
proc sort data= Texas_set;                                                                                                                                                                                                                                      
by sbp dbp;                                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Texas_sbp_dbp1;                                                                                                                                                                                                                                            
set Texas_set;                                                                                                                                                                                                                                                  
if dbp NE . && sbp NE . && dbp>sbp;                                                                                                                                                                                                                             
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_sbp_dbp1;                                                                                                                                                                                                                               
title 'TX dbp greater than sbp';                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
data Texas_sbp_dbp2;                                                                                                                                                                                                                                            
set Texas_set;                                                                                                                                                                                                                                                  
if dbp>110 && sbp> 180;                                                                                                                                                                                                                                         
keep subject dbp sbp;                                                                                                                                                                                                                                           
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_sbp_dbp2;                                                                                                                                                                                                                               
title 'TX dbp > 110 && sbp > 180';                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*************Age************/                                                                                                                                                                                                                                  
/*link:http://www.businessinsider.com/us-states-with-the-highest-and-lowest-life-expectancy-2017-5*/                                                                                                                                                            
/*set age over 90 is unusual*/                                                                                                                                                                                                                                  
proc sort data = Texas_set;                                                                                                                                                                                                                                     
by descending age;                                                                                                                                                                                                                                              
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
data Texas_age1;                                                                                                                                                                                                                                                
set Texas_set;                                                                                                                                                                                                                                                  
if age>90;                                                                                                                                                                                                                                                      
keep subject age;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_age1;                                                                                                                                                                                                                                   
title 'TX Age unusual';                                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
*Elder who has normal blood pressure;                                                                                                                                                                                                                           
data Texas_age2;                                                                                                                                                                                                                                                
set Texas_set;                                                                                                                                                                                                                                                  
if age >60 && age < 110 && sbp<120 && dbp<90;                                                                                                                                                                                                                   
keep subject age sbp dbp;                                                                                                                                                                                                                                       
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_age2;                                                                                                                                                                                                                                   
title 'TX Elder normal blood pressure';                                                                                                                                                                                                                         
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************pregnant*************/                                                                                                                                                                                                                       
*At 45, a woman's likelihood of getting pregnant is no more than 3 or 4 percent.;                                                                                                                                                                               
*link:http://www.parents.com/getting-pregnant/trying-to-conceive/getting-pregnant-at-every-pregnancy-age/;                                                                                                                                                      
data Texas_age3;                                                                                                                                                                                                                                                
set Texas_set;                                                                                                                                                                                                                                                  
if age>45 && pregnancy = 1;                                                                                                                                                                                                                                     
keep subject age pregnancy;                                                                                                                                                                                                                                     
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/*****************tc***************/                                                                                                                                                                                                                            
/*link:https://en.wikipedia.org/wiki/Triglyceride*/                                                                                                                                                                                                             
*500 or higher Very high - high risk;                                                                                                                                                                                                                           
data Texas_tg;                                                                                                                                                                                                                                                  
set Texas_set;                                                                                                                                                                                                                                                  
if tg>500;                                                                                                                                                                                                                                                      
keep subject tg;                                                                                                                                                                                                                                                
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
proc print data = Texas_tg;                                                                                                                                                                                                                                     
title 'TX unusual tg';                                                                                                                                                                                                                                          
run;                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                
/******************ldl****************/                                                                                                                                                                                                                         
/*link:https://www.health.harvard.edu/heart-health/hdl-cholesterol-how-much-is-enough;                                                                                                                                                                          
 *Less than 100 mg/dL           Optimal                                                                                                                                                                                                                         
 *190 mg/dL and above           Very High                                                                                                                                                                                                                       
 *Then we consider that ldl over 190 is unusual*/                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                
data Texas_ldl;                                                                                                                                                                                                                                                 
set Texas_set;                                                                                                                                                                                                                                                  
if ldl>200 then output;                                                                                                                                                                                                                                         
keep subject ldl;                                                                                                                                                                                                                                               
run;                                                                                                                                                                                                                                                            
proc print data = Texas_ldl;                                                                                                                                                                                                                                    
title 'TX ldl over 200';                                                                                                                                                                                                                                        
run;
